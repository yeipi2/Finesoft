@inject NavigationManager Navigation
@inject AuthenticationStateProvider AuthStateProvider

@code {
    [Parameter] public string RedirectTo { get; set; } = "/iniciar-sesion";

    protected override async Task OnInitializedAsync()
    {
        var authState = await AuthStateProvider.GetAuthenticationStateAsync();
        var isAuth = authState.User.Identity?.IsAuthenticated == true;

        if (!isAuth)
        {
            var currentUri = Navigation.ToBaseRelativePath(Navigation.Uri);

            // Evita loop si ya está en login
            if (!currentUri.StartsWith("iniciar-sesion", StringComparison.OrdinalIgnoreCase))
            {
                Navigation.NavigateTo(RedirectTo, forceLoad: true);
            }
        }
    }
}