@* Sidebar de detalles del ticket: Cliente/Proyecto, Detalles y Tiempo *@
@using fs_front.DTO

@* ── Card: Cliente y Proyecto ── *@
<div class="card mb-4">
    <div class="card-header">
        <h6 class="mb-0"><i class="bi bi-building"></i> Cliente y Proyecto</h6>
    </div>
    <div class="card-body">
        <div class="mb-3">
            <small class="text-muted">Cliente</small>
            <div class="fw-bold">@Ticket.ClientName</div>
        </div>
        <div class="mb-3">
            <small class="text-muted">Proyecto</small>
            <div class="fw-bold">@Ticket.ProjectName</div>
        </div>
    </div>
</div>

@* ── Card: Detalles ── *@
<div class="card mb-4">
    <div class="card-header">
        <h6 class="mb-0"><i class="bi bi-list-check"></i> Detalles</h6>
    </div>
    <div class="card-body">
        <div class="mb-3">
            <small class="text-muted">Creado por</small>
            <div>@Ticket.CreatedByUserName</div>
            <small class="text-muted">@Ticket.CreatedAt.ToString("dd/MM/yyyy HH:mm")</small>
        </div>
        <div class="mb-3">
            <small class="text-muted">Asignado a</small>
            <div>
                @if (!string.IsNullOrEmpty(Ticket.AssignedToUserName))
                {
                    <span>@Ticket.AssignedToUserName</span>
                }
                else
                {
                    <span class="text-muted">Sin asignar</span>
                }
            </div>
        </div>
        @if (Ticket.UpdatedAt.HasValue)
        {
            <div class="mb-3">
                <small class="text-muted">Última actualización</small>
                <div>@Ticket.UpdatedAt.Value.ToString("dd/MM/yyyy HH:mm")</div>
            </div>
        }
        @if (Ticket.ClosedAt.HasValue)
        {
            <div>
                <small class="text-muted">Cerrado</small>
                <div>@Ticket.ClosedAt.Value.ToString("dd/MM/yyyy HH:mm")</div>
            </div>
        }
    </div>
</div>

@* ── Card: Tiempo ── *@
<div class="card">
    <div class="card-header">
        <h6 class="mb-0"><i class="bi bi-clock"></i> Tiempo</h6>
    </div>
    <div class="card-body">
        <div class="mb-3">
            <small class="text-muted">Horas Estimadas</small>
            <div class="h4 mb-0">@Ticket.EstimatedHours.ToString("0.00")h</div>
        </div>
        <div>
            <small class="text-muted">Horas Reales</small>
            <div class="h4 mb-0 text-success">@Ticket.ActualHours.ToString("0.00")h</div>
        </div>
        @if (Ticket.ActualHours > Ticket.EstimatedHours)
        {
            <div class="alert alert-warning mt-3 mb-0">
                <small>
                    <i class="bi bi-exclamation-triangle"></i>
                    Excedido por @((Ticket.ActualHours - Ticket.EstimatedHours).ToString("0.00"))h
                </small>
            </div>
        }
    </div>
</div>

@code {
    [Parameter, EditorRequired] public TicketDetailDto Ticket { get; set; } = default!;
}
